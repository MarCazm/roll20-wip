<script type="text/worker">
    on("change:FORCE", function(){
            getAttrs(["FORCE"], function(values) {
                var carac=parseInt(values.FORCE) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>12 && carac<16) {modcar=1;}
                    else if (carac>15 && carac<18) {modcar=2;}
                    else if (carac>17) {modcar=3;}
                    else {modcar=0;}
                setAttrs({
                    FOR: modcar
                });
            });
        });
    on("change:INTELLIGENCE", function(){
            getAttrs(["INTELLIGENCE"], function(values) {
                var carac=parseInt(values.INTELLIGENCE) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>12 && carac<16) {modcar=1;}
                    else if (carac>15 && carac<18) {modcar=2;}
                    else if (carac>17) {modcar=3;}
                    else {modcar=0;}
                setAttrs({
                    INT: modcar
                });
            });
        });
    on("change:SAGESSE", function(){
            getAttrs(["SAGESSE"], function(values) {
                var carac=parseInt(values.SAGESSE) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>12 && carac<16) {modcar=1;}
                    else if (carac>15 && carac<18) {modcar=2;}
                    else if (carac>17) {modcar=3;}
                    else {modcar=0;}
                setAttrs({
                    SAG: modcar
                });
            });
        });
    on("change:DEXTERITE", function(){
            getAttrs(["DEXTERITE"], function(values) {
                var carac=parseInt(values.DEXTERITE) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>12 && carac<16) {modcar=1;}
                    else if (carac>15 && carac<18) {modcar=2;}
                    else if (carac>17) {modcar=3;}
                    else {modcar=0;}
                setAttrs({
                    DEX: modcar
                });
            });
        });
    on("change:CONSTITUTION", function(){
            getAttrs(["CONSTITUTION"], function(values) {
                var carac=parseInt(values.CONSTITUTION) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>12 && carac<16) {modcar=1;}
                    else if (carac>15 && carac<18) {modcar=2;}
                    else if (carac>17) {modcar=3;}
                    else {modcar=0;}
                setAttrs({
                    CON: modcar
                });
            });
        });
    on("change:CHARISME", function(){
            getAttrs(["CHARISME"], function(values) {
                var carac=parseInt(values.CHARISME) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>12 && carac<16) {modcar=1;}
                    else if (carac>15 && carac<18) {modcar=2;}
                    else if (carac>17) {modcar=3;}
                    else {modcar=0;}
                setAttrs({
                    CHA: modcar
                });
            });
        });
    on("change:FORXP change:INTXP change:SAGXP change:DEXXP change:CONXP change:CHAXP", function(){
            getAttrs(["FORXP","INTXP","SAGXP","DEXXP","CONXP","CHAXP"], function(values) {
                var total=(parseInt(values.FORXP) || 0)
                + (parseInt(values.INTXP) || 0)
                + (parseInt(values.SAGXP) || 0)
                + (parseInt(values.DEXXP) || 0)
                + (parseInt(values.CONXP) || 0)
                + (parseInt(values.CHAXP) || 0);
                setAttrs({
                    XPBONUS: total
                });
            });
        });
    on("change:DVDES change:DVBONUS", function(){
            getAttrs(["DVDES","DVBONUS"], function(values) {
                var dvtxt='';
                if (values.DVBONUS == '0') {
                    dvtxt = '' + values.DVDES;
                } else {
                    dvtxt = '' + values.DVDES + '+' + values.DVBONUS;
                }
                setAttrs({
                    DV: dvtxt
                });
            });
        });
</script>
<div class="sheet-bgmain">
    <!-- ========================================================= -->
    <!-- ===================== NOM CLASSE ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 80px;top:14px;">
        <input name="attr_character_name" class="sheet-iptbig1" type="text" placeholder="Nom du personnage"/>
    </div>
    <div class="sheet-absinp" style="left: 130px;top:68px;">
        <input name="attr_CLASSE" class="sheet-iptbig2" type="text" placeholder="Classe de personnage"/>
    </div>
    <!-- ========================================================= -->
    <!-- ===================== XP NIVEAU ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 425px;top:9px;background-color:white;font-weight:bold;">
        <input name="attr_XP" class="sheet-iptnumsm" type="number" title="Points d'expérience courants" value="0" min="0" />
        <b>/</b>
        <input name="attr_XP_max" class="sheet-iptnumsm" type="number" title="Points d'expérience nécessaires pour le prochain niveau" value="0" min="0" />
    </div>
    <div class="sheet-absinp" style="left: 455px;top:40px;">
        <input name="attr_NIVEAU" class="sheet-iptnumbig" type="number" title="Niveau" value="0" min="0" />
    </div>
    <div class="sheet-absinp" style="left: 467px;top:90px;">
        <input readonly name="attr_XPBONUS" class="sheet-iptnumsm" type="number" title="Bonus d'XP" value="0" min="0" /><b>%</b>
    </div>
    <!-- ========================================================= -->
    <!-- ===================== CARACS ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 445px;top:135px;">
        <input name="attr_FORCE" class="sheet-iptnumrond"  type="number" title="Force" value="0" />
    </div>
    <div class="sheet-absinp" style="left:505px;top:166px;">
        <input readonly name="attr_FOR" class="sheet-iptnummod" style="width:25px;" type="number" title="Modificateur de Force" value="0" />
    </div>
    <div class="sheet-absinp" style="left:428px;top:127px;">
        <input name="attr_FORXP" class="sheet-iptnumsm" style="width:20px;" type="number" title="Bonus d'XP de Force" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 445px;top:204px;">
        <input name="attr_INTELLIGENCE" class="sheet-iptnumrond"  type="number" title="Intelligence" value="0" />
    </div>
    <div class="sheet-absinp" style="left:505px;top:235px;">
        <input readonly name="attr_INT" class="sheet-iptnummod" style="width:25px;" type="number" title="Modificateur d'Intelligence" value="0" />
    </div>
    <div class="sheet-absinp" style="left:428px;top:196px;">
        <input name="attr_INTXP" class="sheet-iptnumsm" style="width:20px;" type="number" title="Bonus d'XP de Force" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 445px;top:273px;">
        <input name="attr_SAGESSE" class="sheet-iptnumrond"  type="number" title="Sagesse" value="0" />
    </div>
    <div class="sheet-absinp" style="left:505px;top:304px;">
        <input readonly name="attr_SAG" class="sheet-iptnummod" style="width:25px;" type="number" title="Modificateur de Sagesse" value="0" />
    </div>
    <div class="sheet-absinp" style="left:428px;top:265px;">
        <input name="attr_SAGXP" class="sheet-iptnumsm" style="width:20px;" type="number" title="Bonus d'XP de Sagesse" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 445px;top:341px;">
        <input name="attr_DEXTERITE" class="sheet-iptnumrond"  type="number" title="Dextérité" value="0" />
    </div>
    <div class="sheet-absinp" style="left:505px;top:372px;">
        <input readonly name="attr_DEX" class="sheet-iptnummod" style="width:25px;" type="number" title="Modificateur de Dextérité" value="0" />
    </div>
    <div class="sheet-absinp" style="left:428px;top:333px;">
        <input name="attr_DEXXP" class="sheet-iptnumsm" style="width:20px;" type="number" title="Bonus d'XP de Dextérité" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 445px;top:410px;">
        <input name="attr_CONSTITUTION" class="sheet-iptnumrond"  type="number" title="Constitution" value="0" />
    </div>
    <div class="sheet-absinp" style="left:505px;top:441px;">
        <input readonly name="attr_CON" class="sheet-iptnummod" style="width:25px;" type="number" title="Modificateur de Constitution" value="0" />
    </div>
    <div class="sheet-absinp" style="left:428px;top:402px;">
        <input name="attr_CONXP" class="sheet-iptnumsm" style="width:20px;" type="number" title="Bonus d'XP de Constitution" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 445px;top:479px;">
        <input name="attr_CHARISME" class="sheet-iptnumrond"  type="number" title="Charisme" value="0" />
    </div>
    <div class="sheet-absinp" style="left:505px;top:510px;">
        <input readonly name="attr_CHA" class="sheet-iptnummod" style="width:25px;" type="number" title="Modificateur de Charisme" value="0" />
    </div>
    <div class="sheet-absinp" style="left:428px;top:471px;">
        <input name="attr_CHAXP" class="sheet-iptnumsm" style="width:20px;" type="number" title="Bonus d'XP de Charisme" value="0" />
    </div>
    <!-- ========================================================= -->
    <!-- ===================== CAPA COMBAT COMPETENCES ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 39px;top:140px;">
        <textarea name="attr_CAPACITES" class="sheet-inptxt" style="width:382px;height:80px;text-indent:75px;"></textarea>
    </div>
    <div class="sheet-absinp" style="left: 82px;top:230px;">
        <textarea name="attr_COMBAT" class="sheet-inptxt" style="width:338px;height:80px;text-indent:20px;"></textarea>
    </div>
    <div class="sheet-absinp" style="left: 34px;top:268px;">
        <input name="attr_BAB" class="sheet-iptnumrondsm"  type="number" title="Bonus d'Attaque de Base" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 39px;top:321px;">
        <textarea name="attr_COMPETENCES" class="sheet-inptxt" style="width:382px;height:80px;text-indent:105px;"></textarea>
    </div>
    <!-- ========================================================= -->
    <!-- ===================== PROTECTIONS CA SAUVEGARDES PV ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 39px;top:438px;">
        <textarea name="attr_PROTECTIONS" class="sheet-inptxt" style="width:120px;height:57px;" type="text"></textarea>
    </div>
    <div class="sheet-absinp" style="left: 34px;top:499px;">
        <input name="attr_MOUVEMENT" class="sheet-iptnumrondsm"  type="number" title="Mouvement" value="6" min="0" />
    </div>
    <div class="sheet-absinp" style="left: 80px;top:510px;">
        <input name="attr_CABONUS" class="sheet-iptnumsm" style="max-width:35px;" type="number" title="Bonus de CA (armure, protection etc.)" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 122px;top:499px;">
        <input disabled name="attr_CA" class="sheet-iptnumrondsm" type="number" value="[[10+(@{DEX})+(@{CABONUS})]]" title="Bonus de CA (armure, protection etc.)" />
    </div>
    <div class="sheet-absinp" style="left: 170px;top:438px;">
        <textarea name="attr_SAUVEGARDES" class="sheet-inptxt" style="width:120px;height:57px;" type="text"></textarea>
    </div>
    <div class="sheet-absinp" style="left: 254px;top:499px;">
        <input name="attr_JS" class="sheet-iptnumrondsm"  type="number" title="Jet de Sauvegarde" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 305px;top:445px;">
        <input name="attr_PV" class="sheet-iptnumbig" style="width:50px;" type="number" title="Points de Vie courants" value="0" />
        <span style="vertical-align:middle;line-height: 30px;min-height: 40px;font-weight:bold;font-size:26px;">/</span>
        <input name="attr_PV_max" class="sheet-iptnumbig" style="width:50px;" type="number" title="Points de Vie maximums" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 302px;top:508px;">
        (<input name="attr_DVDES" class="sheet-iptnumsm" style="width:20px;" type="number" title="Nombre de Dés de Vie" value="1" />d6
        +
        <input name="attr_DVBONUS" class="sheet-iptnumsm" style="width:20px;" type="number" title="Bonus aux Dés de Vie" value="0" />)
    </div>
    <div class="sheet-absinp" style="left: 386px;top:499px;">
        <input readonly name="attr_DV" type="text" class="sheet-iptnumrondsm" style="font-size:16px;" value="1" title="Dés de Vie" />
    </div>
    <!-- ========================================================= -->
    <!-- ============ EQUIPEMENT ================================= -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 604px;top:108px;">
        <textarea name="attr_EQUIPEMENT" class="sheet-inptxt" style="width:442px;height:200px;" type="text"></textarea>
    </div>
    <div class="sheet-absinp" style="left: 1052px;top:78px;">
        <input name="attr_RESSOURCES" class="sheet-iptnumrond" style="font-size: 22px;" type="number" title="Ressources" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 598px;top:316px;">
        <input name="attr_ENCOMBREMENT" class="sheet-iptnumrondsm" style="max-width:35px;" type="number" title="Encombrement" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 646px;top:316px;">
        <span style="vertical-align:middle;line-height: 30px;min-height: 40px;font-weight:bold;font-size:26px;">/</span>
        <input disabled name="attr_ENCOMBREMENT_max" class="sheet-iptnumrondsm" style="border:2px solid #939598;" type="number" title="Encombrement maximum" value="5+@{FOR}" />
    </div>
    <!-- ========================================================= -->
    <!-- ============ ATTAQUES   ================================= -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 600px;top:370px;border:2px solid #939598;border-radius:5px;width:499px;text-align:left;padding:2px;">
        <span style="color:black;font-family:'Candal',Helvetica;font-weight:bold;font-size:14px;">ATTAQUES</span>
        <fieldset class="repeating_attaques">
            <button type="roll" class="sheet-boutav" name="AttaqueAv" title="Attaque avec Avantage"></button>
            <button type="roll" name="Attaque" title="Attaque normale"></button>
            <button type="roll" class="sheet-boutdes" name="AttaqueDes" title="Attaque avec Désavantage"></button>
            <input type="text" name="attr_atknom" style="width:144px;height:22px;" placeholder="Nom de l'arme/attaque"/>
            <select name="attr_atkcarac" size="1"  style="text-align: left; width: 50px;" title="Bonus de caractéristique à l'attaque">
                        <option value="0">-</option>
                        <option value="@{FOR}" selected>FOR</option>
                        <option value="@{DEX}">DEX</option>
                        <option value="@{INT}">INT</option>
                        <option value="@{SAG}">SAG</option>
                        <option value="@{CON}">CON</option>
                        <option value="@{CHA}">CHA</option>
            </select>+<input type="number" name="attr_atkbonus" style="width:35px;height:22px;" title="Bonus à l'attaque" value="0" />
            | <i>Dégâts</i>
            <input type="text" name="attr_atkdegats" style="width:58px;height:22px;" placeholder="ex:1d6+1" title="Dégâts" />+<select name="attr_atkdegcarac" size="1"  style="text-align: left; width: 50px;" title="Bonus de caractéristique aux dégâts">
                        <option value="0">-</option>
                        <option value="@{FOR}" selected>FOR</option>
                        <option value="@{DEX}">DEX</option>
                        <option value="@{INT}">INT</option>
                        <option value="@{SAG}">SAG</option>
                        <option value="@{CON}">CON</option>
                        <option value="@{CHA}">CHA</option>
            </select>
            <input type="text" name="attr_atkprops" style="margin-left:78px;width:412px;height:22px;" placeholder="Type, Qualités, Propriétés etc ... "/>
        </fieldset>
    </div>
</div>
