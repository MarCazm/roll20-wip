<script type="text/worker">
    on("change:strength", function(){
            getAttrs(["strength"], function(values) {
                var carac=parseInt(values.strength) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>13 && carac<17) {modcar=1;}
                    else if (carac>16) {modcar=2;}
                    else {modcar=0;}
                setAttrs({
                    STR: modcar
                });
            });
        });
    on("change:intelligence", function(){
            getAttrs(["intelligence"], function(values) {
                var carac=parseInt(values.intelligence) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>13 && carac<17) {modcar=1;}
                    else if (carac>16) {modcar=2;}
                    else {modcar=0;}
                setAttrs({
                    INT: modcar
                });
            });
        });
    on("change:wisdom", function(){
            getAttrs(["wisdom"], function(values) {
                var carac=parseInt(values.wisdom) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>13 && carac<17) {modcar=1;}
                    else if (carac>16) {modcar=2;}
                    else {modcar=0;}
                setAttrs({
                    WIS: modcar
                });
            });
        });
    on("change:dexterity", function(){
            getAttrs(["dexterity"], function(values) {
                var carac=parseInt(values.dexterity) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>13 && carac<17) {modcar=1;}
                    else if (carac>16) {modcar=2;}
                    else {modcar=0;}
                setAttrs({
                    DEX: modcar
                });
            });
        });
    on("change:constitution", function(){
            getAttrs(["constitution","constitution_max"], function(values) {
                var carac=parseInt(values.constitution) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>13 && carac<17) {modcar=1;}
                    else if (carac>16) {modcar=2;}
                    else {modcar=0;}
                setAttrs({
                    CON: modcar
                });
            });
        });
    on("change:charisma", function(){
            getAttrs(["charisma","charisma_max"], function(values) {
                var carac=parseInt(values.charisma) || 0;
                var modcar=0;
                if (carac <3) {modcar=-3;}
                    else if (carac>2 && carac<5) {modcar=-2;}
                    else if (carac>4 && carac<8) {modcar=-1;}
                    else if (carac>13 && carac<17) {modcar=1;}
                    else if (carac>16) {modcar=2;}
                    else {modcar=0;}
                setAttrs({
                    CHA: modcar
                });
            });
        });
    on("change:STRXP change:INTXP change:WISXP change:DEXXP change:CONXP change:CHAXP", function(){
            getAttrs(["STRXP","INTXP","WISXP","DEXXP","CONXP","CHAXP"], function(values) {
                var total=(parseInt(values.STRXP) || 0)
                + (parseInt(values.INTXP) || 0)
                + (parseInt(values.WISXP) || 0)
                + (parseInt(values.DEXXP) || 0)
                + (parseInt(values.CONXP) || 0)
                + (parseInt(values.CHAXP) || 0);
                setAttrs({
                    XPBONUS: total
                });
            });
        });
</script>
<div class="sheet-bgmain">
    <!-- ========================================================= -->
    <!-- ===================== NAME LANGUAGES CLASS ABILITES ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 50px;top:25px;">
        <span class="sheet-libBlanc1" data-i18n="agentdetails-u">agent details</span>
    </div>
    <div class="sheet-absinp" style="left: 27px;top:67px;">
        <span class="sheet-libGris1" data-i18n="name-u">name</span>
    </div>
    <div class="sheet-absinp" style="left: 90px;top:57px;">
        <input name="attr_character_name" class="sheet-iptbig1" style="width:246px;height:36px;border-radius: 0 0 20px 0;" type="text" data-i18n-placeholder="character-name-ph" placeholder="Character name"/>
    </div>
    <div class="sheet-absinp" style="left: 18px;top:102px;">
        <span class="sheet-libGris2" data-i18n="languages-u">languages</span>
    </div>
    <div class="sheet-absinp" style="left: 10px;top:102px;">
        <textarea name="attr_languages" class="sheet-inptxt" style="border-radius:15px 0 0 20px;width:312px;height:62px;text-indent:85px;"></textarea>
    </div>
    <div class="sheet-absinp" style="left: 27px;top:182px;">
        <span class="sheet-libGris1" data-i18n="class-u">class</span>
    </div>
    <div class="sheet-absinp" style="left: 110px;top:174px;">
        <input name="attr_class" class="sheet-iptbig2" style="border-radius:0 12px 0 0;width:224px;height:36px;" type="text" data-i18n-placeholder="class-ph" placeholder="Class"/>
    </div>
    <div class="sheet-absinp" style="left: 34px;top:220px;">
        <span class="sheet-libGris2" data-i18n="abilities-u">abilities / notes</span>
    </div>
    <div class="sheet-absinp" style="left: 32px;top:219px;">
        <textarea name="attr_abilities" class="sheet-inptxt" style="width:302px;height:356px;text-indent:150px;"></textarea>
    </div>
    <!-- ========================================================= -->
    <!-- ===================== XP LELVE BONUS SUPP-TRAINING ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 335px;top:90px;">
        <span class="sheet-libGris2" data-i18n="xp-u">xp</span>
    </div>
    <div class="sheet-absinp" style="left: 357px;top:89px;background-color:white;font-weight:bold;">
        <input name="attr_XP" class="sheet-iptnumsm" type="number" data-i18n-title="title-xp" title="Current experience points" value="0" min="0" />
        <b>/</b>
        <input name="attr_XP_max" class="sheet-iptnumsm sheet-max" style="border-radius:0 10px 0 0;" type="number" data-i18n-title="title-xp-max" title="Experience points required for next level" value="0" min="0" />
    </div>
    <div class="sheet-absinp" style="left: 332px;top:128px;">
        <span class="sheet-libGris1" data-i18n="level-u">level</span>
    </div>
    <div class="sheet-absinp" style="left: 392px;top:119px;">
        <input name="attr_NIVEAU" class="sheet-iptnumbig" type="number" style="border-radius:0 12px 12px 0;min-width:62px;" data-i18n-title="title-level" title="Level" value="0" min="0" />
    </div>
    <div class="sheet-absinp" style="left: 338px;top:162px;">
        <span class="sheet-libGris3" data-i18n="xp-bonus-u">xp bonus</span>
    </div>
    <div class="sheet-absinp" style="left: 396px;top:162px;">
        <input readonly name="attr_XPBONUS" class="sheet-iptnumsm" type="number" data-i18n-title="title-xp-bonus" title="XP Bonus" value="0" min="0" /><span style="font-family:arial;">&nbsp;%</span>
    </div>
    <div class="sheet-absinp" style="left: 586px;top:104px;">
        <span class="sheet-libBlanc2" data-i18n="supp-training-u">supplemental training</span>
    </div>
    <div class="sheet-absinp" style="left: 464px;top:128px;">
        <textarea name="attr_training" class="sheet-inptxt" style="border-radius:0px 20px 0px 0px;width:346px;height:118px;"></textarea>
    </div>
    <!-- ========================================================= -->
    <!-- ===================== CHARACTERISTICS ===== -->
    <!-- ========================================================= -->
    <!-- ===================== STRENGTH ===== -->
    <div class="sheet-absinp" style="left: 345px;top:191px;">
        <input name="attr_strength" class="sheet-iptnumrondtop"  type="number" data-i18n-title="strength-ph" title="Strength" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 360px;top:220px;">
        <button type="roll" class="sheet-boutcar" style="display:block" name="StrRoll" data-i18n-title="str-roll-ph" title="Strength check" value="&{template:roll} {{character=@{character_name}}} {{lib=^{strength-ph}}} {{rol=1}} {{roll=[[1d20+(@{STR})[Mod]+(?{Bonus|0})[Bonus]]]}}"></button>
    </div>
    <div class="sheet-absinp" style="left: 404px;top:192px;">
        <span class="sheet-libBlanc0" data-i18n="str-u">STR</span>
    </div>
    <div class="sheet-absinp" style="left:411px;top:225px;">
        <input readonly name="attr_STR" class="sheet-iptnummod" style="width:25px;" type="number" data-i18n-title="str-ph" title="Strength modifier" value="0" />
    </div>
    <!-- ===================== INTELLIGENCE ===== -->
    <div class="sheet-absinp" style="left: 345px;top:253px;">
        <input name="attr_intelligence" class="sheet-iptnumrondtop"  type="number" data-i18n-title="intelligence-ph" title="Intelligence" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 360px;top:282px;">
        <button type="roll" class="sheet-boutcar" style="display:block" name="IntRoll" data-i18n-title="int-roll-ph" title="Intelligence check" value="&{template:roll} {{character=@{character_name}}} {{lib=^{intelligence-ph}}} {{rol=1}} {{roll=[[1d20+(@{INT})[Mod]+(?{Bonus|0})[Bonus]]]}}"></button>
    </div>
    <div class="sheet-absinp" style="left: 404px;top:254px;">
        <span class="sheet-libBlanc0" data-i18n="int-u">INT</span>
    </div>
    <div class="sheet-absinp" style="left:411px;top:287px;">
        <input readonly name="attr_INT" class="sheet-iptnummod" style="width:25px;" type="number" data-i18n-title="int-ph" title="Intelligence modifier" value="0" />
    </div>
    <!-- ===================== WISDOM ===== -->
    <div class="sheet-absinp" style="left: 345px;top:315px;">
        <input name="attr_wisdom" class="sheet-iptnumrondtop"  type="number" data-i18n-title="wisdom-ph" title="Wisdom" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 360px;top:344px;">
        <button type="roll" class="sheet-boutcar" style="display:block" name="WisRoll" data-i18n-title="wis-roll-ph" title="Wisdom check" value="&{template:roll} {{character=@{character_name}}} {{lib=^{wisdom-ph}}} {{rol=1}} {{roll=[[1d20+(@{WIS})[Mod]+(?{Bonus|0})[Bonus]]]}}"></button>
    </div>
    <div class="sheet-absinp" style="left: 404px;top:316px;">
        <span class="sheet-libBlanc0" data-i18n="wis-u">WIS</span>
    </div>
    <div class="sheet-absinp" style="left:411px;top:349px;">
        <input readonly name="attr_WIS" class="sheet-iptnummod" style="width:25px;" type="number" data-i18n-title="wis-ph" title="Wisdom modifier" value="0" />
    </div>
    <!-- ===================== DEXTERITY ===== -->
    <div class="sheet-absinp" style="left: 345px;top:377px;">
        <input name="attr_dexterity" class="sheet-iptnumrondtop"  type="number" data-i18n-title="dexterity-ph" title="Dexterity" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 360px;top:406px;">
        <button type="roll" class="sheet-boutcar" style="display:block" name="DexRoll" data-i18n-title="dex-roll-ph" title="Dexterity check" value="&{template:roll} {{character=@{character_name}}} {{lib=^{dexterity-ph}}} {{rol=1}} {{roll=[[1d20+(@{DEX})[Mod]+(?{Bonus|0})[Bonus]]]}}"></button>
    </div>
    <div class="sheet-absinp" style="left: 404px;top:378px;">
        <span class="sheet-libBlanc0" data-i18n="dex-u">DEX</span>
    </div>
    <div class="sheet-absinp" style="left:411px;top:411px;">
        <input readonly name="attr_DEX" class="sheet-iptnummod" style="width:25px;" type="number" data-i18n-title="dex-ph" title="Dexterity modifier" value="0" />
    </div>
    <!-- ===================== CONSTITUTION ===== -->
    <div class="sheet-absinp" style="left: 345px;top:439px;">
        <input name="attr_constitution" class="sheet-iptnumrondtop"  type="number" data-i18n-title="constitution-ph" title="Constitution" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 360px;top:468px;">
        <button type="roll" class="sheet-boutcar" style="display:block" name="ConRoll" data-i18n-title="con-roll-ph" title="Constitution check" value="&{template:roll} {{character=@{character_name}}} {{lib=^{constitution-ph}}} {{rol=1}} {{roll=[[1d20+(@{CON})[Mod]+(?{Bonus|0})[Bonus]]]}}"></button>
    </div>
    <div class="sheet-absinp" style="left: 404px;top:440px;">
        <span class="sheet-libBlanc0" data-i18n="con-u">CON</span>
    </div>
    <div class="sheet-absinp" style="left:411px;top:473px;">
        <input readonly name="attr_CON" class="sheet-iptnummod" style="width:25px;" type="number" data-i18n-title="con-ph" title="Constitution modifier" value="0" />
    </div>
    <!-- ===================== CHARISMA ===== -->
    <div class="sheet-absinp" style="left: 345px;top:501px;">
        <input name="attr_charisma" class="sheet-iptnumrondtop"  type="number" data-i18n-title="charisma-ph" title="Charisma" value="0" />
    </div>
    <div class="sheet-absinp" style="left: 360px;top:530px;">
        <button type="roll" class="sheet-boutcar" style="display:block" name="ChaRoll" data-i18n-title="cha-roll-ph" title="Charisma check" value="&{template:roll} {{character=@{character_name}}} {{lib=^{charisma-ph}}} {{rol=1}} {{roll=[[1d20+(@{CHA})[Mod]+(?{Bonus|0})[Bonus]]]}}"></button>
    </div>
    <div class="sheet-absinp" style="left: 404px;top:502px;">
        <span class="sheet-libBlanc0" data-i18n="cha-u">CHA</span>
    </div>
    <div class="sheet-absinp" style="left:411px;top:535px;">
        <input readonly name="attr_CHA" class="sheet-iptnummod" style="width:25px;" type="number" data-i18n-title="con-ph" title="Charisma modifier" value="0" />
    </div>
    <!-- ========================================================= -->
    <!-- ===================== EQUIPMENTS ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 470px;top:272px;">
        <span class="sheet-libBlanc1" data-i18n="equipment-u">equipment</span>
    </div>
    <div class="sheet-absinp" style="left: 721px;top:261px;">
        <input name="attr_wealth" class="sheet-iptnumbig2" style="border-radius: 0 12px 12px 0;min-width:100px;height:41px;" type="number" value="0" />
    </div>
    <div class="sheet-absinp" style="overflow-y:scroll;left:462px;top:310px;width:350px;height:490px;">
        <fieldset class="repeating_equipments">
            <div class="sheet-ligne">
                <input type="text" name="attr_equipname" style="width:284px;" data-i18n-placeholder="item-name-ph" placeholder="Item name and description" />
                <input type="number" name="attr_equipqty" style="width:40px;" data-i18n-title="item-quantity-ph" title="Quantity" value="1" />
            </div>
        </fieldset>
    </div>
    <!-- ========================================================= -->
    <!-- ===================== HIT POINTS SAVING THROWS ARMOR ===== -->
    <!-- ========================================================= -->
    <div class="sheet-absinp" style="left: 40px;top:603px;">
        <span class="sheet-libBlanc1" data-i18n="hit-points-u">hit points</span>
    </div>
    <div class="sheet-absinp" style="left: 159px;top:594px;">
        <input name="attr_HP" class="sheet-iptnumrondtop" type="number" value="0" data-i18n-title="hit-points-current-ph" title="Current Hit Points" />
    </div>
    <div class="sheet-absinp" style="left: 159px;top:623px;">
        <input name="attr_HP_max" class="sheet-iptnumrondbott sheet-max" type="number" value="0" data-i18n-title="hit-points-max-ph" title="Maximum Hit Points" />
    </div>
    <div class="sheet-absinp" style="left: 30px;top:660px;">
        <span class="sheet-libGris2" data-i18n="hitdice-u">hit dice</span>
        <span class="sheet-libGris2"> : </span>
        <input name="attr_HD" class="sheet-iptnumsm" style="width:20px;" type="number" data-i18n-title="hitdice-nb-ph" title="Number of Hit Dice" value="1" />
        <span class="sheet-libGris2">d6 + </span>
        <input name="attr_HDBONUS" class="sheet-iptnumsm" style="width:20px;" type="number" data-i18n-title="hitdice-bonus-ph" title="Hit Dice Bonus" value="0" />
        <button type="roll" class="sheet-boutjs" name="HdRoll" data-i18n-title="hitdice-roll-ph" title="Hit Dice roll" value="&{template:roll} {{character=@{character_name}}} {{lib=^{hitdice-ph}}} {{rol=1}} {{roll=[[@{HD}d6+@{HDBONUS}]]}}"></button>
    </div>
    <!-- ========================================================= -->
    <!-- ===================== WEAPONS ATTACKS ===== -->
    <!-- ========================================================= -->
</div>
<!-- ========================================================= -->
<!-- ============ TEMPLATE   ================================= -->
<!-- ========================================================= -->
<rolltemplate class="sheet-rolltemplate-roll">
    <div class="sheet-tplmain">
        <div class="sheet-perso">{{character}}</div>
        {{#rol}}
            <div class="sheet-jets">
                <div class="sheet-borderd">{{lib}}</div>
                <div class="sheet-jet">{{roll}}</div>
            </div>
        {{/rol}}
        {{#dmg}}
            <div class="sheet-jets">
                <div class="sheet-borderd">
                    <span data-i18n="damage-u">damage</span>
                </div>
            {{#rollLess() dmg 1}}
                <div class="sheet-jet">1</div>
            {{/rollLess() dmg 1}}
            {{#rollGreater() dmg 0}}
                <div class="sheet-jet">{{dmg}}</div>
            {{/rollGreater() dmg 0}}
            </div>
        {{/dmg}}
    </div>
</rolltemplate>
